[env:esp8266_4mb]
platform = espressif8266
board = esp01_1m
framework = arduino

; 4MB flash configuration
board_build.flash_mode = dout
board_build.f_cpu = 80000000L
board_build.f_flash = 40000000L
board_build.flash_size = 4MB

; Use 2MB linker script for compatibility with old KC firmware OTA
board_build.ldscript = eagle.flash.2m.ld

; Build settings
build_flags =
    -DPIO_FRAMEWORK_ARDUINO_LWIP2_LOW_MEMORY
    -D MIGRATOR_VERSION=\"1.0.0\"
    -Os  ; Optimize for size

; Sign firmware after build for KC OTA compatibility
extra_scripts = post:sign_firmware.py

monitor_speed = 115200
;monitor_speed = 74880
; monitor_speed = 9600
upload_speed = 921600
